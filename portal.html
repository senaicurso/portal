<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portal da Feira de Ciências</title>
    <!-- Carrega o Tailwind CSS para estilização -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Carrega a fonte Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* Estilos globais e fontes */
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            background-color: #0d1117; /* Fundo escuro sólido (mais rápido) */
            color: #e2e8f0; /* Texto claro */
        }
        main {
            flex-grow: 1;
            /* Garante espaço para o header e footer fixos */
            padding-top: 5rem; 
            padding-bottom: 3rem; 
        }
    </style>
</head>
<body class="bg-gray-900">

    <!-- HEADER FIXO -->
    <header class="fixed top-0 left-0 w-full bg-cyan-800 shadow-xl z-10">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3 flex justify-between items-center">
            <h1 class="text-2xl font-extrabold text-white tracking-wider">PORTAL INTERATIVO</h1>
            <!-- O onclick é gerenciado pelo script, mas a função precisa estar no escopo global (window) -->
            <button id="home-button" onclick="window.navigateTo('home')" class="bg-cyan-600 hover:bg-cyan-500 text-white font-bold py-2 px-4 rounded-full transition duration-300 shadow-md">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block mr-1" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z" />
                </svg>
                Início
            </button>
        </div>
    </header>

    <!-- CONTEÚDO PRINCIPAL DINÂMICO -->
    <!-- O script irá preencher este 'main' -->
    <main id="main-content" class="container mx-auto p-4 sm:p-8 flex items-center justify-center"></main>

    <!-- FOOTER FIXO -->
    <footer class="fixed bottom-0 left-0 w-full bg-cyan-800 text-white text-center p-2 text-sm shadow-xl z-10">
        &copy; 2024 Projeto Feira de Ciências | Utilize os QR Codes para acessar o conhecimento!
    </footer>

    <!-- 
      SCRIPT CORRIGIDO
      Este script agora roda com 'DOMContentLoaded' para evitar a página em branco.
    -->
    <script type="module">
        // Variável de estado para rastrear a página atual
        let currentPage = 'home';
        // 'mainContent' será buscado *depois* que o DOM carregar
        let mainContent; 
        let BASE_QR_URL = ''; // Será definido quando o DOM carregar

        // --- MOCK DATA E UTILITÁRIOS ---

        // Dados simulados para os temas
        const themes = {
            'a': {
                title: 'Eletricidade Estática: O Poder do Atrito',
                description: 'Explore como os objetos podem ganhar ou perder elétrons, gerando fenômenos incríveis como atrair pequenos pedaços de papel ou arrepiar os cabelos! Este tema detalha o experimento clássico do balão e os princípios da triboeletricidade. [Imagem de Experimento de eletricidade estática]',
                media: `
                    <div class="aspect-video w-full max-w-lg mx-auto bg-gray-900 rounded-lg overflow-hidden shadow-2xl">
                        <!-- VÍDEO SIMULADO DO YOUTUBE -->
                        <iframe class="w-full h-full" src="https://www.youtube.com/embed/z12M8Y70G4Q" title="Vídeo sobre Eletricidade Estática" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                    </div>
                `
            },
            'b': {
                title: 'O Mundo Invisível: Microbiologia',
                description: 'Mergulhe no universo dos microrganismos! Descubra como bactérias, fungos e vírus afetam nossas vidas, tanto na saúde (boas e más) quanto na produção de alimentos (como pão e iogurte). [Imagem de Microscópio analisando microorganismos]',
                media: `
                    <!-- MÚLTIPLAS IMAGENS RESPONSIVAS -->
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 w-full max-w-4xl mx-auto">
                        <img src="https://placehold.co/600x400/10b981/ffffff?text=Cultura+de+Bactérias" alt="Cultura de Bactérias" class="rounded-lg shadow-xl object-cover w-full h-48 sm:h-64 transition duration-300 hover:opacity-90" onerror="this.src='httpshttps://placehold.co/600x400/10b981/ffffff?text=Microbiologia-1'" />
                        <img src="https://placehold.co/600x400/f87171/ffffff?text=Vírus+em+Célula" alt="Vírus em Célula" class="rounded-lg shadow-xl object-cover w-full h-48 sm:h-64 transition duration-300 hover:opacity-90" onerror="this.src='https://placehold.co/600x400/f87171/ffffff?text=Microbiologia-2'" />
                    </div>
                `
            },
            'c': {
                title: 'Energia Renovável: O Futuro Sustentável',
                description: 'Conheça as principais fontes de energia limpa e inesgotável: solar, eólica e hídrica. Entenda a importância da transição energética para combater as mudanças climáticas e garantir a sustentabilidade do planeta. [Imagem de Fazenda de energia solar e eólica]',
                media: `
                    <!-- MÚLTIPLAS IMAGENS EM LAYOUT FLEXÍVEL -->
                    <div class="flex flex-col md:flex-row gap-4 w-full max-w-4xl mx-auto">
                        <img src="https://placehold.co/400x300/f59e0b/ffffff?text=Painel+Solar" alt="Painel Solar" class="w-full md:w-1/3 rounded-lg shadow-2xl object-cover h-48 md:h-64" onerror="this.src='httpshttps://placehold.co/400x300/f59e0b/ffffff?text=Solar'" />
                        <img src="https://placehold.co/400x300/0ea5e9/ffffff?text=Torre+Eólica" alt="Torre Eólica" class="w-full md:w-1/3 rounded-lg shadow-2xl object-cover h-48 md:h-64" onerror="this.src='https://placehold.co/400x300/0ea5e9/ffffff?text=Eólica'" />
                        <img src="https://placehold.co/400x300/60a5fa/ffffff?text=Hidrelétrica" alt="Hidrelétrica" class="w-full md:w-1/3 rounded-lg shadow-2xl object-cover h-48 md:h-64" onerror="this.src='httpshttps://placehold.co/400x300/60a5fa/ffffff?text=Hídrica'" />
                    </div>
                `
            }
        };

        /**
         * Obtém um parâmetro específico da query string do URL.
         * @param {string} param - O nome do parâmetro.
         * @returns {string | null} O valor do parâmetro ou null.
         */
        function getQueryParam(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }

        /**
         * Simula a navegação mudando o estado e atualizando o URL para que o QR Code funcione.
         * @param {string} page - Chave do tema ('a', 'b', 'c') ou 'home'.
         */
        window.navigateTo = function(page) {
            currentPage = page;
            renderPage();
            window.scrollTo(0, 0); // Volta para o topo ao mudar de página

            // Atualiza o URL do navegador (sem recarregar) para simular o comportamento do QR Code
            try {
                if (page === 'home') {
                    history.pushState(null, '', BASE_QR_URL);
                } else {
                    history.pushState(null, '', BASE_QR_URL + `?tema=${page}`);
                }
            } catch (e) {
                console.warn("Não foi possível atualizar o histórico do navegador:", e);
            }
        }

        // --- RENDERIZAÇÃO DAS PÁGINAS ---

        function renderHomePage() {
            // Garante que a página inicial tenha o layout centralizado para os QR Codes
            mainContent.classList.remove('flex-col', 'justify-start');
            mainContent.classList.add('flex', 'items-center', 'justify-center');
            // Garante altura mínima para telas menores na home
            mainContent.classList.add('min-h-[calc(100vh-8rem)]');

            mainContent.innerHTML = `
                <div class="text-center p-8 bg-gray-800/80 backdrop-blur-sm rounded-2xl shadow-2xl max-w-6xl w-full border-b-8 border-cyan-500">
                    <h2 class="text-4xl sm:text-5xl font-extrabold text-cyan-400 mb-8 tracking-tight">
                        BEM-VINDO(A) À NOSSA FEIRA DE CIÊNCIAS!
                    </h2>
                    <p class="text-lg text-gray-300 mb-12 max-w-3xl mx-auto">
                        Use a câmera do seu celular para ler os QR Codes e explore os temas de perto.
                        Ou clique diretamente neles para simular a leitura!
                    </p>

                    <div class="flex flex-col md:flex-row justify-center items-stretch gap-8">

                        <!-- QR Code TEMA A -->
                        <div onclick="window.navigateTo('a')" class="cursor-pointer group bg-gray-900 p-4 rounded-xl transition duration-300 transform hover:scale-[1.03] hover:shadow-cyan-500/50 shadow-xl border-t-4 border-cyan-500">
                            <h3 class="text-xl font-bold text-cyan-300 mb-3 group-hover:text-white">${themes.a.title.split(':')[0]}</h3>
                            <div class="bg-white p-2 rounded-lg inline-block">
                                <!-- O QR Code agora codifica a URL base com o parâmetro ?tema=a -->
                                <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${encodeURIComponent(BASE_QR_URL + '?tema=a')}" alt="QR Code Tema A" class="w-32 h-32 md:w-40 md:h-40 object-contain"/>
                            </div>
                            <p class="text-xs text-gray-400 mt-2">Simula leitura do QR Code</p>
                        </div>

                        <!-- QR Code TEMA B -->
                        <div onclick="window.navigateTo('b')" class="cursor-pointer group bg-gray-900 p-4 rounded-xl transition duration-300 transform hover:scale-[1.03] hover:shadow-cyan-500/50 shadow-xl border-t-4 border-cyan-500">
                            <h3 class="text-xl font-bold text-cyan-300 mb-3 group-hover:text-white">${themes.b.title.split(':')[0]}</h3>
                            <div class="bg-white p-2 rounded-lg inline-block">
                                <!-- O QR Code agora codifica a URL base com o parâmetro ?tema=b -->
                                <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${encodeURIComponent(BASE_QR_URL + '?tema=b')}" alt="QR Code Tema B" class="w-32 h-32 md:w-40 md:h-40 object-contain"/>
                            </div>
                            <p class="text-xs text-gray-400 mt-2">Simula leitura do QR Code</p>
                        </div>

                        <!-- QR Code TEMA C -->
                        <div onclick="window.navigateTo('c')" class="cursor-pointer group bg-gray-900 p-4 rounded-xl transition duration-300 transform hover:scale-[1.03] hover:shadow-cyan-500/50 shadow-xl border-t-4 border-cyan-500">
                            <h3 class="text-xl font-bold text-cyan-300 mb-3 group-hover:text-white">${themes.c.title.split(':')[0]}</h3>
                            <div class="bg-white p-2 rounded-lg inline-block">
                                <!-- O QR Code agora codifica a URL base com o parâmetro ?tema=c -->
                                <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${encodeURIComponent(BASE_QR_URL + '?tema=c')}" alt="QR Code Tema C" class="w-32 h-32 md:w-40 md:h-40 object-contain"/>
                            </div>
                            <p class="text-xs text-gray-400 mt-2">Simula leitura do QR Code</p>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderThemePage(themeKey) {
            const theme = themes[themeKey];
            if (!theme) {
                // Se o tema não for encontrado, redireciona para a home
                window.navigateTo('home');
                return;
            }
            
            // Remove o estilo de centralização para permitir rolagem de conteúdo longo
            mainContent.classList.remove('items-center', 'justify-center', 'min-h-[calc(100vh-8rem)]');
            mainContent.classList.add('flex-col', 'justify-start');

            mainContent.innerHTML = `
                <div class="w-full max-w-5xl mx-auto p-6 md:p-10 bg-gray-800/90 backdrop-blur-sm rounded-2xl shadow-2xl border-b-8 border-cyan-500 min-h-[calc(100vh-10rem)]">
                    <h2 class="text-3xl sm:text-4xl font-extrabold text-cyan-400 mb-6 text-center tracking-tight">
                        ${theme.title}
                    </h2>

                    <!-- Área de Mídia (Vídeo ou Imagem) -->
                    <div class="mb-8 p-4 bg-gray-900 rounded-xl shadow-inner">
                        <p class="text-sm text-gray-400 mb-4">Conteúdo Interativo (Vídeos e Imagens):</p>
                        ${theme.media}
                    </div>

                    <!-- Descrição do Tema -->
                    <div class="prose max-w-none text-gray-200">
                        <p class="text-lg leading-relaxed border-l-4 border-cyan-500 pl-4 bg-gray-900 p-4 rounded-lg shadow-inner">
                            ${theme.description}
                        </p>

                        <h3 class="mt-8 text-2xl font-bold text-cyan-300">Aprofunde-se no Tema</h3>
                        <ul class="list-disc list-inside space-y-2 text-gray-300 ml-4">
                            <li><strong class="text-cyan-200">Pesquisa:</strong> Utilize o Google Search para encontrar mais sobre ${theme.title.split(':')[0]}.</li>
                            <li><strong class="text-cyan-200">Curiosidade:</strong> Como esse conceito está presente em sua vida?</li>
                            <li><strong class="text-cyan-200">Perguntas:</strong> Quais questões você faria ao professor sobre este assunto?</li>
                        </ul>
                    </div>

                    <div class="mt-12 text-center">
                        <button onclick="window.navigateTo('home')" class="bg-pink-600 hover:bg-pink-500 text-white font-bold py-3 px-8 rounded-full text-lg transition duration-300 shadow-lg hover:shadow-pink-500/50">
                            Voltar à Página Inicial
                        </button>
                    </div>
                </div>
            `;
        }

        function renderPage() {
            // Adiciona uma verificação de segurança
            if (!mainContent) {
                console.error("ERRO CRÍTICO: Elemento 'main-content' não foi encontrado.");
                document.body.innerHTML = "<h1 style='color: red; text-align: center; margin-top: 50px;'>Erro Crítico: A aplicação não pôde ser carregada. ID 'main-content' não encontrado.</h1>";
                return;
            }

            if (currentPage === 'home') {
                renderHomePage();
            } else if (themes[currentPage]) {
                renderThemePage(currentPage);
            } else {
                // Se a página não for 'home' nem um tema válido, volta para 'home'
                currentPage = 'home';
                renderHomePage();
            }
        }

        // --- INICIALIZAÇÃO DA APLICAÇÃO ---
        // **** A CORREÇÃO ESTÁ AQUI ****
        // Usar DOMContentLoaded em vez de window.onload
        document.addEventListener('DOMContentLoaded', () => {
            
            // Busca o 'main-content' *depois* que o DOM está pronto
            mainContent = document.getElementById('main-content');
            
            // Define a URL base (lidando com 'index.html' no caminho)
            let path = window.location.pathname;
            // Remove 'index.html' se estiver presente
            if (path.endsWith('index.html')) {
                path = path.substring(0, path.lastIndexOf('/') + 1);
            }
            // Garante que o caminho termine com '/' se não for a raiz
            if (!path.endsWith('/')) {
                path += '/';
            }
            
            // Corrige o caso de estar num subdiretório (ex: /repo-name/
            // ou na raiz (ex: /)
            BASE_QR_URL = window.location.origin + path;
            
            // Remove a barra final da URL base para o history.pushState
            // (Evita barras duplas se o path for só "/")
            if (BASE_QR_URL.length > 1 && BASE_QR_URL.endsWith('/')) {
                BASE_QR_URL = BASE_QR_URL.substring(0, BASE_QR_URL.length - 1);
            }


            const initialTheme = getQueryParam('tema'); // Verifica se há '?tema=A' no URL

            if (initialTheme && themes[initialTheme.toLowerCase()]) {
                // Se houver um tema válido no URL, navega diretamente para ele.
                currentPage = initialTheme.toLowerCase();
            } else if (window.location.search && window.history.pushState) {
                // Se houver qualquer outro parâmetro, limpa e vai para a home.
                try {
                    history.pushState(null, '', BASE_QR_URL);
                } catch (e) {
                    console.warn("Não foi possível limpar o histórico de URL:", e);
                }
            }
            
            // Renderiza a página
            renderPage();
        });

    </script>
</body>
</html>